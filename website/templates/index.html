{% extends 'base.html' %}

{% block content %}
<!--- Main -->
<main>

    <!-- Modal for Login button -->
    <div class="modal fade" id="loginModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="exampleModalLabel">User Message</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                </div>
                <div class="modal-body">
                    You're in! You can now create and book events.
                </div>
                <div class="modal-footer">
                    <button id="loginModalButton" type="button" class="btn btn-primary btn-md custom-btn"
                        data-bs-dismiss="modal">
                        Got it!
                    </button>
                </div>
            </div>
        </div>
    </div>
    <!-- Carousel -->
    <div class="carousel-container">
        <div class="row">
            <div class="col-12 col-md-2 col-lg-3"></div>

            <div class="col-12 col-md-3 col-lg-3 mx-md-auto text-center mt-4">
                <h2 class="max-width-500 mb-5"><br><br>Book an experience and live like a local on your next getaway</h2>
            </div>

            <!--------------------------------------- ** NOTE FOR MARKER ** --------------------------------------->
            <!--- Please note that not all styling for lottie image can be moved to style sheet hence why some styling is below  -->
            <!--- Also Lottie image is not imported locally as this couldn't be done without paying for premium image  -->

            <!-- Lottie animation container - large -->
            <div class="col-12 col-md-3 col-lg-3">
                <div class="lottie-container">
                    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
                    <div style="width: 450px; height: 350px; overflow: hidden;">
                        <lottie-player src="https://lottie.host/a5653a4f-9375-4c6a-8598-e9f612d4a866/8ZEHwQnFD4.json"
                            background="#849BFF" speed="1" style="width: 450px; height: 450px; margin-top: -50px;" loop autoplay
                            direction="1" mode="normal"></lottie-player>
                    </div>
                </div>
            </div>

            <div class="col-md-3"></div>

            <!-- Lottie animation container - mid-medium -->
            <div class="col-md-12 col-md-3 col-lg-3">
                <div class="lottie-container-mid-medium" style="width: 650px; height: 350px; overflow: hidden; text-align: center;">
                    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
                    <div style="width: 100%; height: 100%; display: inline-block; vertical-align: middle;">
                        <lottie-player src="https://lottie.host/a5653a4f-9375-4c6a-8598-e9f612d4a866/8ZEHwQnFD4.json"
                            background="#849BFF" speed="1" style="width: 100%; max-height: 100%;" loop autoplay direction="1"
                            mode="normal"></lottie-player>
                    </div>
                </div>
            </div>

            <!-- Lottie animation container - medium -->
            <div class="col-md-12 col-md-3 col-lg-3">
                <div class="lottie-container-medium" style="width: 550px; height: 350px; overflow: hidden; text-align: center;">
                    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
                    <div style="width: 100%; height: 100%; display: inline-block; vertical-align: middle;">
                        <lottie-player src="https://lottie.host/a5653a4f-9375-4c6a-8598-e9f612d4a866/8ZEHwQnFD4.json"
                            background="#849BFF" speed="1" style="width: 100%; max-height: 100%;" loop autoplay direction="1"
                            mode="normal"></lottie-player>
                    </div>
                </div>
            </div>


            <!-- Lottie animation container - small -->
            <div class="col-md-12 col-md-3 col-lg-3">
                <div class="lottie-container-small" style="width: 350px; height: 350px; overflow: hidden; text-align: center;">
                    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
                    <div style="width: 100%; height: 100%; display: inline-block; vertical-align: middle;">
                        <lottie-player src="https://lottie.host/a5653a4f-9375-4c6a-8598-e9f612d4a866/8ZEHwQnFD4.json"
                            background="#849BFF" speed="1" style="width: 100%; max-height: 100%;" loop autoplay direction="1"
                            mode="normal"></lottie-player>
                    </div>
                </div>
            </div>

            <div class="col-12 col-md-3 col-lg-3"></div>
        </div>
    </div>


    <!-- Cards -->
    <div class="container wrapper">

    <!-- Radio category buttons -->
    <div class="container wrapper">
        <br>
        <div class="toggle-button-group">
            <h3 class="custom-heading">Book an experience</h3>
            <div class="drop-down-container">
                <button class="btn btn-outline-light me-2 custom-btn toggle-button" data-type="all">
                    All
                </button>
                <button class="btn btn-outline-light me-2 custom-btn toggle-button" data-type="art-culture">
                    Art & Culture
                </button>
                <button class="btn btn-outline-light me-2 custom-btn toggle-button" data-type="tours">
                    Tours
                </button>
                <button class="btn btn-outline-light me-2 custom-btn toggle-button" data-type="food-drink">
                    Food & Drink
                </button>
                <button class="btn btn-outline-light me-2 custom-btn toggle-button" data-type="unique">
                    Unique
                </button>

                <!-- Filter dropdown with custom class -->
                <div class="dropdown">
                    <button class="btn btn-outline-light me-2 custom-btn filter-button" type="button" id="filterDropdown"
                        data-bs-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <i class="bi bi-filter custom-filter-icon"></i>
                    </button>
                    <div class="dropdown-menu" aria-labelledby="filterDropdown">
                        <a class="dropdown-item" href="#" data-status="all">All</a>
                        <a class="dropdown-item" href="#" data-status="open">Open</a>
                        <a class="dropdown-item" href="#" data-status="inactive">Inactive</a>
                        <a class="dropdown-item" href="#" data-status="sold-out">Sold Out</a>
                        <a class="dropdown-item" href="#" data-status="cancelled">Cancelled</a>
                    </div>
                </div>
            </div>
        </div>

        <hr>

        <!-- Cards -->
        <div class="row justify-content-left">
            
            <!--- No results filter message-->
            <div id="noResultsMessage">
                <br>
                <div class="centered-message">
                    <br>
                    <h5>No results found. Please try another filter.</h5>
                </div>
            </div>

            <!-- Row 1 -->
            <!-- Card 1 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="tours" data-status="open">
                    <div class="card box-shadow mx-auto homepage-card">
                        <a href="/event">
                        <img src="./static/img/kayak-tour.png" class="card-img-top" alt="Man kayaking on river">
                        
                        <!-- Status box in the top right corner -->
                        <div class="status-green">
                            Open
                        </div></a>
                        <div class="card-body">
                            <h6 class="card-title">
                                <b>
                                <span class="homepage-card-name">Noosa Kayak Adventure</span>
                                <span class="homepage-card-duration">2hrs</span>
                                <div class="homepage-card-spacer"></div>
                                </b>
                            </h6>
                            <hr>
                            <p class="card-text">Hosted by Paul - $99pp</p>
                        </div>
                    </div>
            </div>

            <!-- Card 2 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="tours" data-status="sold-out"> 
                <div class="card box-shadow mx-auto homepage-card">
                    <a href="/event">
                    <img src="./static/img/acropolis-tour.png" class="card-img-top" alt="Acropolis">

                    <!-- Status box in the top right corner -->
                    <div class="status-red">
                        Sold Out
                    </div></a>

                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Acropolis Guided Tour</span>
                            <span class="homepage-card-duration">3hrs</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6>
                        <hr>
                        <p class="card-text">Hosted by Adonius - $149pp<br></p>
                    </div>
                </div>
            </div>

            <!-- Card 3 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="food-drink" data-status="cancelled"> 
                <div class="card box-shadow mx-auto homepage-card">
                    <a href="/event">
                    <img src="./static/img/pasta-class.png" class="card-img-top" alt="Nona rolling pasta with 2 women">
                    
                    <!-- Status box in the top right corner -->
                    <div class="status-black">
                        Cancelled
                    </div></a>
                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Italian Cooking Class</span>
                            <span class="homepage-card-duration">1.5hrs</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6><hr>
                        <p class="card-text">Hosted by Nona - $99pp<br></p>
                    </div>
                </div>
            </div>

            <!-- Card 4 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="unique" data-status="inactive">
                <div class="card box-shadow mx-auto homepage-card">
                    <a href="/event">
                    <img src="./static/img/atlas-camel-ride.png" class="card-img-top" alt="Group of people riding camels in desert">

                    <!-- Status box in the top right corner -->
                    <div class="status-grey">
                        Inactive
                    </div></a>

                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Sahari Desert Camel Ride</span>
                            <span class="homepage-card-duration">1hr</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6><hr>
                        <p class="card-text">Hosted by Sahib - $49pp<br></p>
                    </div>
                </div>
            </div>

            <!-- Row 2 -->
            <!-- Card 1 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="tours" data-status="open">
                <div class="card box-shadow mx-auto homepage-card">
                    <a href="/event">
                    <img src="./static/img/Nanhbinh-day-trip.png" class="card-img-top" alt="Woman wearing red dress and hat floating in boat">
                    <!-- Status box in the top right corner -->
                    <div class="status-green">
                        Open
                    </div></a>

                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Nahh Binh Day Trip</span>
                            <span class="homepage-card-duration">6hrs</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6>
                        <hr>
                        <p class="card-text">Hosted by Ru - $299pp</p>
                    </div>
                </div>
            </div>
                
            <!-- Card 2 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="tours" data-status="sold-out">
                <div class="card box-shadow mx-auto homepage-card">
                    <a href="/event">
                    <img src="./static/img/tubing.png" class="card-img-top" alt="Group of people floating down river in colourful rubber rings">
        
                    <!-- Status box in the top right corner -->
                    <div class="status-red">
                        Sold Out
                    </div></a>
            
                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Boozy Lazy Tipsy Tubing</span>
                            <span class="homepage-card-duration">3hrs</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6><hr>
                        <p class="card-text">Hosted by Jack - $79pp<br></p>
                    </div>
                </div>
            </div>
                
            <!-- Card 3 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="food-drink" data-status="cancelled">
                <div class="card box-shadow mx-auto homepage-card">
                    <a href="/event">
                    <img src="./static/img/strings-forest.png" class="card-img-top" alt="Man playing violine in woods to audience">
                    <!-- Status box in the top right corner -->
                    <div class="status-black">
                        Cancelled
                    </div></a>
                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Strings in the Woods</span>
                            <span class="homepage-card-duration">1.5hrs</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6><hr>
                        <p class="card-text">Hosted by Will - $60pp<br></p>
                    </div>
                </div>
            </div>
                
            <!-- Card 4 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="unique" data-status="inactive">
                    <div class="card box-shadow mx-auto homepage-card">
                        <a href="/event">
                        <img src="./static/img/chef-tour.png" class="card-img-top" alt="Chef wearing black clothes standing next to fruit hosting tour">
                        <!-- Status box in the top right corner -->
                        <div class="status-grey">
                            Inactive
                        </div></a>
            
                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Chef Tour of Pike Parade</span>
                            <span class="homepage-card-duration">4hrs</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6><hr>
                        <p class="card-text">Hosted by Jonas - $150pp<br></p>
                    </div>
                </div>
            </div>

            <!-- Row 3 -->
            <!-- Card 1 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="unique" data-status="open">
                <div class="card box-shadow mx-auto homepage-card">
                    <a href="/event">
                    <img src="./static/img/cigar-tasting.png" class="card-img-top" alt="Man wearing glasses and hat holding liquor and lit cigar">

                    <!-- Status box in the top right corner -->
                    <div class="status-green">
                        Open
                    </div>
                    </a>

                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Havana Cigar Tasting</span>
                            <span class="homepage-card-duration">3hrs</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6><hr>
                        <p class="card-text">Hosted by Yoel - $189pp<br></p>
                    </div>
                </div>
            </div>
            
            <!-- Card 2 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="tours" data-status="open">
                    <div class="card box-shadow mx-auto homepage-card">
                        <a href="/event">
                        <img src="./static/img/jack-ripper-tour.png" class="card-img-top" alt="Foggy archway with people walking under it">
                
                    <!-- Status box in the top right corner -->
                    <div class="status-green">
                        Open
                    </div></a>

                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Jack Ripper Evening Tour</span>
                            <span class="homepage-card-duration">3hrs</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6><hr>
                        <p class="card-text">Hosted by Jen - $99pp<br></p>
                    </div>
                </div>
            </div>
            
            <!-- Card 3 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="art-culture" data-status="open">
                <div class="card box-shadow mx-auto homepage-card">
                    <a href="/event">
                    <img src="./static/img/kimino-kyoto.png" class="card-img-top" alt="Woman dressing another woman in kimono">
                    
                    <!-- Status box in the top right corner -->
                    <div class="status-green">
                        Open
                    </div>
                    </a>

                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Kiminos in Kyoto</span>
                            <span class="homepage-card-duration">2hrs</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6>
                        <hr>
                        <p class="card-text">Hosted by Aoi - $49pp<br></p>
                    </div>
                </div>
            </div>
            
            <!-- Card 4 -->
            <div class="custom-card mx-auto mx-3 left-align-card" data-type="tours" data-status="open">
                <div class="card box-shadow mx-auto homepage-card">
                    <a href="/event">
                    <img src="./static/img/cherry-blossom-tour.png" class="card-img-top" alt="...">
            
                    <!-- Status box in the top right corner -->
                    <div class="status-green">
                        Open
                    </div></a>

                    <div class="card-body">
                        <h6 class="card-title"><b>
                            <span class="homepage-card-name">Toyko Cherry Blossoms</span>
                            <span class="homepage-card-duration">1hr</span>
                            <div class="homepage-card-spacer"></div></b>
                        </h6><hr>
                        <p class="card-text">Hosted by Mokoto - $70pp<br></p>
                    </div>
                </div>
            </div>
        </div>


        <!-- JS scripting import -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.1/dist/js/bootstrap.bundle.min.js" integrity="sha384-HwwvtgBNo3bZJJLYd8oVXjrBZt8cqVSpeBNS5n7C8IVInixGAoxmnlMuBnhbgrkm" crossorigin="anonymous"></script>
        
        <!-- JS to handle button click events and toggle "pressed" state -->
        <script>
                document.addEventListener("DOMContentLoaded", function () {
                const buttons = document.querySelectorAll(".toggle-button");

                buttons.forEach(function (button) {
                    button.addEventListener("click", function () {
                        buttons.forEach(function (otherButton) {
                            otherButton.classList.remove("active");
                        });
                        this.classList.add("active");
                    });
                });
            });
        </script>

        <!-- JS to handle login modal script -->
        <script>
            const loginButton = document.getElementById("loginButton");
            const loginModal = new bootstrap.Modal(document.getElementById("loginModal"));
            const loginModalBody = document.querySelector("#loginModal .modal-body");
            const experiencesLink = document.getElementById("experiencesLink");
            const bookingHistoryLink = document.getElementById("bookingHistoryLink");
            const loginMessage = document.getElementById("loginMessage");
            const ticketSelector = document.getElementById("ticketSelector");

            let isLoggedIn = false;

            loginButton.addEventListener("click", function () {

                // User is logged out
                if (isLoggedIn) {
                    loginModalBody.textContent = "It was great having you. See you next time.";
                    loginButton.textContent = "Login";

                    // Hide the Experiences link
                    experiencesLink.style.display = "none";

                    // Hide the Book History link
                    bookingHistoryLink.style.display = "none";

                    // Disable Book now button
                    bookNowBtn.disabled = true;

                    // Disable ticket selector
                    ticketSelector.disabled = true;

                } else {
                    // User is logged in
                    loginModalBody.textContent = "You're in! You can now create and book events.";
                    loginButton.textContent = "Logout";

                    // Show the Experiences link
                    experiencesLink.style.display = "block";

                    // Show the Book History link
                    bookingHistoryLink.style.display = "block";

                    // Enable the "Book Now" button
                    bookNowBtn.disabled = false;

                    // Enable ticket selector
                    ticketSelector.disabled = false;
                }

                // Toggle the login state
                isLoggedIn = !isLoggedIn;

                // Show the login modal
                loginModal.show();
            });
        </script>

        <!-- JS to handle card filtering -->
        <script>
            document.addEventListener("DOMContentLoaded", function () {
                const typeButtons = document.querySelectorAll(".toggle-button");
                const statusDropdown = new bootstrap.Dropdown(document.getElementById("filterDropdown"));
                const cards = document.querySelectorAll(".custom-card.mx-auto.mx-3.left-align-card");

                let global_type = "all";
                let global_status = "all";
                let anyCardsMatch = false;

                // Function to filter cards based on type
                function filterCards(type, status) {
                    
                    // Show/hide the message based on the flag
                    anyCardsMatch = false;
                    
                    cards.forEach(function (card) {
                        const cardType = card.getAttribute("data-type");
                        const cardStatus = card.getAttribute("data-status");

                        if (type === "all" && status === "all") {
                            card.style.display = "block";
                            anyCardsMatch = true;
                        } else if (type === "all" && cardStatus === global_status) {
                            card.style.display = "block";
                            anyCardsMatch = true;
                        } else if (cardType === type && global_status === "all") {
                            card.style.display = "block";
                            anyCardsMatch = true;
                        } else if (cardType === type && cardStatus === global_status) {
                            card.style.display = "block";
                            anyCardsMatch = true;
                        } else {
                            card.style.display = "none";
                        }
                    });

                    // Show/hide the message based on the flag
                    const noResultsMessage = document.getElementById("noResultsMessage");
                    if (anyCardsMatch) {
                        noResultsMessage.style.display = "none";
                    } else {
                        noResultsMessage.style.display = "block";
                    }

                }

                typeButtons.forEach(function (button) {
                    button.addEventListener("click", function () {
                        global_type = this.getAttribute("data-type");
                        filterCards(global_type, global_status);
                    });
                });

                // Add click event listener to the status dropdown items
                const statusItems = document.querySelectorAll(".dropdown-item[data-status]");
                statusItems.forEach(function (item) {
                    item.addEventListener("click", function (event) {
                        event.preventDefault();
                        status = item.getAttribute("data-status");
                        global_status = status
                        filterCards(global_type, global_status);
                    });
                });

                // Initial filter when the page loads
                filterCards(global_type, global_status);
            });
        </script>

</main>

{% endblock %}